"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9919],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>g});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var i=r.createContext({}),c=function(e){var n=r.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},p=function(e){var n=c(e.components);return r.createElement(i.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,s=e.originalType,i=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(t),m=a,g=u["".concat(i,".").concat(m)]||u[m]||d[m]||s;return t?r.createElement(g,o(o({ref:n},p),{},{components:t})):r.createElement(g,o({ref:n},p))}));function g(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var s=t.length,o=new Array(s);o[0]=m;var l={};for(var i in n)hasOwnProperty.call(n,i)&&(l[i]=n[i]);l.originalType=e,l[u]="string"==typeof e?e:a,o[1]=l;for(var c=2;c<s;c++)o[c]=t[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},36744:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>u,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var r=t(87462),a=(t(67294),t(3905));const s={},o=void 0,l={unversionedId:"\u9879\u76ee\u5b9e\u8df5/\u914d\u7f6e/\u914d\u7f6ewebpack/\u57fa\u672c\u914d\u7f6e",id:"\u9879\u76ee\u5b9e\u8df5/\u914d\u7f6e/\u914d\u7f6ewebpack/\u57fa\u672c\u914d\u7f6e",title:"\u57fa\u672c\u914d\u7f6e",description:"\u57fa\u672c\u5b89\u88c5",source:"@site/docs/\u9879\u76ee\u5b9e\u8df5/\u914d\u7f6e/\u914d\u7f6ewebpack/\u57fa\u672c\u914d\u7f6e.md",sourceDirName:"\u9879\u76ee\u5b9e\u8df5/\u914d\u7f6e/\u914d\u7f6ewebpack",slug:"/\u9879\u76ee\u5b9e\u8df5/\u914d\u7f6e/\u914d\u7f6ewebpack/\u57fa\u672c\u914d\u7f6e",permalink:"/docs/\u9879\u76ee\u5b9e\u8df5/\u914d\u7f6e/\u914d\u7f6ewebpack/\u57fa\u672c\u914d\u7f6e",draft:!1,editUrl:"https://github.com/foolishandi/myblog/tree/main/docs/\u9879\u76ee\u5b9e\u8df5/\u914d\u7f6e/\u914d\u7f6ewebpack/\u57fa\u672c\u914d\u7f6e.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u4ee3\u7406\u914d\u7f6e",permalink:"/docs/\u9879\u76ee\u5b9e\u8df5/\u914d\u7f6e/\u914d\u7f6ewebpack/\u4ee3\u7406\u914d\u7f6e"},next:{title:"package.json",permalink:"/docs/category/packagejson"}},i={},c=[{value:"\u57fa\u672c\u5b89\u88c5",id:"\u57fa\u672c\u5b89\u88c5",level:2},{value:"\u63d2\u4ef6\u5b89\u88c5",id:"\u63d2\u4ef6\u5b89\u88c5",level:2},{value:"loader \u76f8\u5173",id:"loader-\u76f8\u5173",level:2},{value:"\u57fa\u672c\u914d\u7f6e",id:"\u57fa\u672c\u914d\u7f6e",level:2}],p={toc:c};function u(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"\u57fa\u672c\u5b89\u88c5"},"\u57fa\u672c\u5b89\u88c5"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"npm i -D webpack webpack-bundle-analyzer webpack-cli webpack-dev-server webpack-merge\n")),(0,a.kt)("h2",{id:"\u63d2\u4ef6\u5b89\u88c5"},"\u63d2\u4ef6\u5b89\u88c5"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"npm i -D html-webpack-plugin mini-css-extract-plugin terser-webpack-plugin optimize-css-assets-webpack-plugin clean-webpack-plugin copy-webpack-plugin\n")),(0,a.kt)("h2",{id:"loader-\u76f8\u5173"},"loader \u76f8\u5173"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"npm i -D babel-loader less-loader style-loader css-loader file-loader postcss-loader url-loader\n")),(0,a.kt)("h2",{id:"\u57fa\u672c\u914d\u7f6e"},"\u57fa\u672c\u914d\u7f6e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const path = require("path");\nconst webpack = require("webpack");\nconst merge = require("webpack-merge");\n\nconst CleanWebpackPlugin = require("clean-webpack-plugin");\nconst HtmlWebpackPlugin = require("html-webpack-plugin");\nconst CopyWebpackPlugin = require("copy-webpack-plugin");\nconst BundleAnalyzerPlugin =\n  require("webpack-bundle-analyzer").BundleAnalyzerPlugin;\n\nconst TerserPlugin = require("terser-webpack-plugin");\nconst OptimizeCssAssetsWebpackPlugin = require("optimize-css-assets-webpack-plugin");\nconst MiniCssExtractPlugin = require("mini-css-extract-plugin");\n\n// nodejs\u83b7\u53d6\u76f8\u5bf9\u8def\u5f84\nfunction resolve(relatedPath) {\n  return path.join(__dirname, relatedPath);\n}\n\n// \u901a\u7528\u57fa\u7840\u914d\u7f6e\nconst baseConfig = {\n  context: resolve("../src"),\n  entry: {\n    index: resolve("../src/index.jsx"),\n  },\n  output: {\n    path: resolve("../dist"),\n    filename: "[name].js",\n    chunkFilename: "chunks/[name].[hash:8].js",\n  },\n  resolve: {\n    extensions: [".js", ".jsx", ".css", ".sass"],\n    alias: {\n      "@src": path.join(__dirname, "../src"),\n      // \u63d0\u53d6\u516c\u5171npm\u5305\u53bb\u91cd\u5931\u8d25\uff0c\u5355\u72ec\u8bbe\u7f6e\u7edd\u5bf9\u8def\u5f84\n      immutable: path.resolve(process.cwd(), "node_modules", "immutable"),\n    },\n  },\n  resolveLoader: {\n    moduleExtensions: ["-loader"],\n  },\n  plugins: [\n    new HtmlWebpackPlugin({\n      template: resolve("../src/index.html"),\n      chunk: ["index"],\n      hash: true, // \u6253\u5305\u6587\u4ef6\u52a0\u4e0ahash\u4e32\n      scriptLoading: "defer",\n    }),\n\n    // new ExtractTextWebpackPlugin(\'css/[name].css\'),\n\n    // \u590d\u5236\u9ad8\u5ea6\u9759\u6001\u6a21\u677f\u8d44\u6e90\n    new CopyWebpackPlugin([\n      {\n        context: resolve("../src/resource/"),\n        from: "**/*",\n        to: resolve("../dist/resource/"),\n      },\n    ]),\n\n    new webpack.HotModuleReplacementPlugin(),\n\n    // \u5c06\u5185\u8054\u6837\u5f0f\u63d0\u53d6\u51fa\u6765\u6210\u6837\u5f0f\u6587\u4ef6\n    new MiniCssExtractPlugin({\n      filename: "css/[name].[contenthash:8].css",\n      chunkFilename: "css/[name].[contenthash:8].css",\n    }),\n  ],\n\n  module: {\n    rules: [\n      {\n        test: /\\.js[x]?$/,\n        // \u6307\u5b9a\u6587\u4ef6\u5939\u5339\u914d\u6587\u4ef6\n        exclude: /node_modules/,\n        include: [resolve("../app")],\n        use: [\n          {\n            loader: "babel-loader",\n            options: {\n              presets: ["react", "es2015", "stage-0"],\n            },\n          },\n        ],\n      },\n      {\n        test: /\\.(less|css|sass)$/,\n        use: [\n          "style-loader",\n          MiniCssExtractPlugin.loader,\n          "css-loader",\n          {\n            loader: "less-loader",\n            options: {\n              lessOptions: {\n                javascriptEnabled: true,\n              },\n            },\n          },\n        ],\n      },\n      {\n        test: /\\.(png|jpe?g|gif|svg)(\\?.*)?$/,\n        exclude: /node_modules/,\n        loader: "url-loader",\n        options: {\n          limit: 8192,\n          name: "../images/[name].[ext]",\n          outputPath: "images/",\n        },\n      },\n      {\n        test: /\\.eot(\\?v=\\d+\\.\\d+\\.\\d+)?$/,\n        loader: "file-loader",\n      },\n      {\n        test: /\\.(woff|woff2)$/,\n        loader: "url-loader?prefix=font/&limit=5000",\n      },\n      {\n        test: /\\.ttf(\\?v=\\d+\\.\\d+\\.\\d+)?$/,\n        loader: "url-loader?limit=10000&mimetype=application/octet-stream",\n      },\n    ],\n  },\n};\n\n// \u5f00\u53d1\u73af\u5883\u914d\u7f6e\nconst devConfig = {\n  devtool: "source-map",\n  devServer: {\n    host: "0.0.0.0",\n    port: 3000,\n    open: true,\n    disableHostCheck: true,\n    // \u5f00\u53d1\u914d\u7f6e\u4ee3\u7406\u6587\u4ef6\n    proxy: require("./dev.config.js"),\n  },\n};\n\n// \u751f\u4ea7\u73af\u5883\u914d\u7f6e\uff0c\u9700\u8981\u6253\u5305\u4f18\u5316\uff0c\u4ee3\u7801\u5206\u5272\uff0cjs\u3001css\u518d\u538b\u7f29\nconst prodConfig = {\n  plugins: [\n    new CleanWebpackPlugin(resolve("../dist"), {\n      root: resolve("../"),\n      verbose: true,\n    }),\n\n    // \u6253\u5305\u5206\u6790\u63d2\u4ef6\uff0c\u751f\u4ea7report\u6587\u4ef6\n    new BundleAnalyzerPlugin({\n      analyzerMode: "static",\n      openAnalyzer: false,\n      analyzerPort: 4000,\n    }),\n\n    // \u6309\u9700\u52a0\u8f7d\u7279\u5b9a\u7b2c\u4e09\u65b9\u5305\n    new webpack.ContextReplacementPlugin(/moment[\\/\\\\]locale$/, /zh-cn/),\n\n    // \u62bd\u79bb\u7b2c\u4e09\u65b9\u5e93\n    //new AutoDllPlugin({\n    //    inject: true,\n    //    filename: \'[name]_dll.js\',\n    //    entry: {\n    //        third1: [\'antd\'],\n    //        third2: [\'moment\', \'immutable\', \'axios\'],\n    //       third3: [\'react\', \'react-dom\', \'react-router\', \'react-router-dom\']\n    //    }\n    //})\n  ],\n\n  // \u4ee3\u7801\u5206\u5272\n  optimization: {\n    // \u538b\u7f29\u6253\u5305\u540e\u7684js\u3001css\u6587\u4ef6\n    minimizer: [\n      new TerserPlugin({\n        terserOptions: {\n          parse: {},\n          compress: {},\n          keep_fnames: false,\n          safari10: false,\n        },\n      }),\n      new OptimizeCssAssetsWebpackPlugin({ canPrint: false, sourceMap: false }),\n    ],\n    // \u4ee3\u7801\u5206\u5272\n    splitChunks: {\n      chunks: "all", //async \u53ea\u5206\u5272\u5f02\u6b65\u5bfc\u5165\u4ee3\u7801 all \u540c\u6b65\u5f02\u6b65\u90fd\u5206\u5272\n      minSize: 30000,\n      maxSize: 0,\n      minChunks: 1,\n      maxAsyncRequests: 5,\n      maxInitialRequests: 3,\n      automaticNameDelimiter: "~",\n      name: true,\n      cacheGroups: {\n        vendors: {\n          test: /[\\\\/]node_modules[\\\\/]/,\n          priority: -10,\n        },\n        // \u5982\u679c\u7b2c\u4e09\u65b9\u603b\u5305\u8fc7\u5927\uff0c\u53ef\u4ee5\u5206\u79bb\u90e8\u5206\u6bd4\u8f83\u5927\u7684\u7b2c\u4e09\u65b9\u5305\u5355\u72ec\u6210\u4e00\u4e2a\u6587\u4ef6\n        thirdDll: {\n          name: "dll",\n          test: /[\\\\/]node_modules[\\\\/](moment|loadsh|immutable)/,\n          priority: 10,\n          reuseExistingChunk: true,\n        },\n        default: {\n          minChunks: 2,\n          priority: -20,\n          reuseExistingChunk: true,\n        },\n      },\n    },\n  },\n};\n\n// \u914d\u7f6e\u5bfc\u51fa\nmodule.exports = (env) => {\n  // nodejs\u547d\u4ee4\uff0c\u83b7\u53d6\u5f53\u524d\u6d4b\u8bd5\u73af\u5883\n  const environment = env.environment;\n  console.info(`\u5f53\u524d\u6d4b\u8bd5\u73af\u5883: ${environment}`);\n\n  if (environment === "DEV") {\n    // \u5408\u5e76\u5f00\u53d1\u914d\u7f6e\u4e0e\u57fa\u7840\u914d\u7f6e\uff0c\u5bfc\u51fa\u914d\u7f6e\n    return merge(baseConfig, devConfig);\n  }\n\n  if (environment === "PRD") {\n    // \u5408\u5e76\u751f\u4ea7\u914d\u7f6e\u4e0e\u57fa\u7840\u914d\u7f6e\uff0c\u5bfc\u51fa\u914d\u7f6e\n    return merge(baseConfig, prodConfig);\n  }\n};\n')))}u.isMDXComponent=!0}}]);